// ==UserScript==
// @name         Gitlab plus
// @namespace    https://lukaszmical.pl/
// @version      2024-10-08
// @description  try to take over the world!
// @author       You
// @match        https://gitlab.com/*
// @icon         https://www.google.com/s2/favicons?sz=64&gitlab.com/
// ==/UserScript==
(()=>{"use strict";var e={61:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(81),a=s.n(n),i=s(645),l=s.n(i)()(a());l.push([e.id,'@keyframes loader-animation{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.glp-issue-modal{position:absolute;display:none;padding:15px;background-color:var(--gl-background-color-default, var(--gl-color-neutral-0, #fff));border:1px solid var(--gl-border-color-default);border-radius:.25rem;width:300px;min-height:300px;z-index:99999}.glp-issue-modal.glp-modal-visible{display:flex}.glp-issue-modal .glp-issue-modal-inner{display:flex;flex-direction:column}.glp-issue-modal .glp-modal-loader{position:absolute;width:40px;height:40px;transform:translate(-50%, -50%);left:50%;top:50%}.glp-issue-modal .glp-modal-loader .glp-modal-loader-inner{position:absolute;width:40px;height:40px;background-color:var(--gl-background-color-subtle, var(--gl-color-neutral-10, #fbfafd));animation:linear 1s infinite loader-animation;border-radius:50%}.glp-issue-modal .glp-modal-loader .glp-modal-loader-inner::after{content:"";position:absolute;background-color:#fff;border-radius:50%;top:5px;left:50%;width:5px;height:5px;transform:translateX(-50%)}.glp-issue-modal .glp-block{padding:.75rem 0 1rem;border-bottom-style:solid;border-bottom-color:var(--gl-border-color-subtle, var(--gl-color-neutral-50, #ececef));border-bottom-width:1px;width:100%}.glp-issue-modal .assignee-grid{margin-top:4px;gap:4px}.glp-image-modal{position:fixed;display:flex;justify-content:center;align-items:center;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);visibility:hidden;opacity:0;pointer-events:none;z-index:99999}.glp-image-modal.glp-modal-visible{visibility:visible;opacity:1;pointer-events:auto}.glp-image-modal .glp-modal-img{max-width:95%;max-height:95%}.glp-image-modal .glp-modal-close{position:absolute;z-index:2;top:20px;right:20px;color:#000;width:40px;height:40px;display:flex;justify-content:center;align-items:center;background:#fff;border-radius:20px;cursor:pointer}',""]);const o=l},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s="",n=void 0!==t[5];return t[4]&&(s+="@supports (".concat(t[4],") {")),t[2]&&(s+="@media ".concat(t[2]," {")),n&&(s+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),s+=e(t),n&&(s+="}"),t[2]&&(s+="}"),t[4]&&(s+="}"),s})).join("")},t.i=function(e,s,n,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var l={};if(n)for(var o=0;o<this.length;o++){var r=this[o][0];null!=r&&(l[r]=!0)}for(var d=0;d<e.length;d++){var c=[].concat(e[d]);n&&l[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),s&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=s):c[2]=s),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),t.push(c))}},t}},81:e=>{e.exports=function(e){return e[1]}},868:(e,t,s)=>{s.r(t),s.d(t,{default:()=>v});var n=s(379),a=s.n(n),i=s(795),l=s.n(i),o=s(569),r=s.n(o),d=s(565),c=s.n(d),u=s(216),p=s.n(u),m=s(589),h=s.n(m),f=s(61),g={};g.styleTagTransform=h(),g.setAttributes=c(),g.insert=r().bind(null,"head"),g.domAPI=l(),g.insertStyleElement=p();a()(f.Z,g);const v=f.Z&&f.Z.locals?f.Z.locals:void 0},379:e=>{var t=[];function s(e){for(var s=-1,n=0;n<t.length;n++)if(t[n].identifier===e){s=n;break}return s}function n(e,n){for(var i={},l=[],o=0;o<e.length;o++){var r=e[o],d=n.base?r[0]+n.base:r[0],c=i[d]||0,u="".concat(d," ").concat(c);i[d]=c+1;var p=s(u),m={css:r[1],media:r[2],sourceMap:r[3],supports:r[4],layer:r[5]};if(-1!==p)t[p].references++,t[p].updater(m);else{var h=a(m,n);n.byIndex=o,t.splice(o,0,{identifier:u,updater:h,references:1})}l.push(u)}return l}function a(e,t){var s=t.domAPI(t);s.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;s.update(e=t)}else s.remove()}}e.exports=function(e,a){var i=n(e=e||[],a=a||{});return function(e){e=e||[];for(var l=0;l<i.length;l++){var o=s(i[l]);t[o].references--}for(var r=n(e,a),d=0;d<i.length;d++){var c=s(i[d]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}i=r}}},569:e=>{var t={};e.exports=function(e,s){var n=function(e){if(void 0===t[e]){var s=document.querySelector(e);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}t[e]=s}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(s)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,s)=>{e.exports=function(e){var t=s.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(s){!function(e,t,s){var n="";s.supports&&(n+="@supports (".concat(s.supports,") {")),s.media&&(n+="@media ".concat(s.media," {"));var a=void 0!==s.layer;a&&(n+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),n+=s.css,a&&(n+="}"),s.media&&(n+="}"),s.supports&&(n+="}");var i=s.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,s)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},807:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.element=e}setStyle(e){Object.entries(e).forEach((([e,t])=>{this.element.style.setProperty(e,`${t}`)}))}setParams(e){Object.entries(e).forEach((([e,t])=>{let s=`${t}`;void 0!==t&&!1!==t||(s=""),this.element.setAttribute(e,s)}))}addClassName(e){this.element.classList.add(e)}event(e,t){this.element.addEventListener(e,t)}getElement(){return this.element}}},981:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=s(807),a=s(682),i=s(322);class l extends n.default{constructor(){super(document.createElement("div")),this.image=new a.default,this.close=new i.default,this.visibleClassName="glp-modal-visible",this.addClassName("glp-image-modal"),this.element.appendChild(this.image.getElement()),this.element.appendChild(this.close.getElement()),this.close.onClick(this.hide.bind(this)),document.body.appendChild(this.element)}show(e){this.image.updateSrc(e),this.element.classList.add(this.visibleClassName)}hide(){this.element.classList.remove(this.visibleClassName),this.image.updateSrc("")}}t.default=l},968:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=s(807),a=s(830),i=s(793);class l extends n.default{constructor(){super(document.createElement("div")),this.loader=new a.default,this.content=new i.IssueModalContent,this.visibleClassName="glp-modal-visible",this.addClassName("glp-issue-modal"),document.body.appendChild(this.element)}show(e){this.element.appendChild(this.loader.getElement()),this.element.style.left=`${e.pageX+5}px`,this.element.style.top=`${e.pageY+5}px`,this.element.classList.add(this.visibleClassName)}hide(){this.element.classList.remove(this.visibleClassName),this.clear()}clear(){this.element.innerHTML=""}updateContent(e){this.content.update(e),this.clear(),this.element.appendChild(this.content.getElement())}}t.default=l},322:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=s(807);class a extends n.default{constructor(){super(document.createElement("div")),this.addClassName("glp-modal-close"),this.element.innerHTML="X"}onClick(e){this.element.addEventListener("click",e)}}t.default=a},682:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=s(807);class a extends n.default{constructor(){super(document.createElement("img")),this.addClassName("glp-modal-img")}updateSrc(e){this.element.src=e}}t.default=a},107:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=s(574);class a extends n.default{constructor(){super("Assignee")}update(e){this.updateContent(e.assignees.map((e=>this.createContent(e))).join(""))}createContent(e){return`\n<div class="assignee-grid gl-flex gl-w-full gl-items-center">\n    <img src="${e.avatar_url}" alt="${e.name}'s avatar" class="gl-avatar gl-avatar-circle gl-avatar-s24"   >\n    <span>${e.name}</span>\n</div>`}}t.default=a},574:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=s(807);class a extends n.default{constructor(e="",t=""){super(document.createElement("div")),this.titleComponent=document.createElement("div"),this.contentComponent=document.createElement("div"),this.addClassName("glp-block"),this.element.appendChild(this.titleComponent),this.titleComponent.classList.add("gl-flex","gl-items-center","gl-font-bold","gl-leading-20","gl-text-gray-900"),this.updateTitle(e),this.element.appendChild(this.contentComponent),this.updateContent(t)}updateTitle(e){this.titleComponent.innerHTML=e}updateContent(e){this.contentComponent.innerHTML=e}}t.default=a},127:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=s(574);class a extends n.default{constructor(){super("Iteration")}update(e){this.updateContent(e.iteration?[e.iteration.start_date,e.iteration.due_date].join(" - "):"")}}t.default=a},922:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=s(574);class a extends n.default{constructor(){super("Labels")}update(e){this.updateContent(e.labels.map((e=>this.createLabel(e))).join(""))}createLabel(e){let t=`<span class="gl-label-text">${e.name}</span>`,s="gl-label hide-collapsed "+("#FFFFFF"===e.text_color?"gl-label-text-light":"gl-label-text-dark");if(e.name.includes("::")){const[n,a]=e.name.split("::");t=`<span class="gl-label-text">${n}</span><span class="gl-label-text-scoped">${a}</span>`,s+=" gl-label-scoped"}return`\n<span class=" ${s}" style="--label-background-color: ${e.color}; --label-inset-border: inset 0 0 0 2px ${e.color};">\n  <span class="gl-link gl-label-link gl-label-link-underline">\n    ${t}\n  </span>\n</span>\n`}}t.default=a},830:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=s(807);class a extends n.default{constructor(){super(document.createElement("div")),this.addClassName("glp-modal-loader");const e=document.createElement("div");e.classList.add("glp-modal-loader-inner"),this.element.appendChild(e)}}t.default=a},715:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=s(574);class a extends n.default{constructor(){super("Milestone")}update(e){this.updateContent(e.milestone?e.milestone.title:"")}}t.default=a},793:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IssueModalContent=void 0;const n=s(807),a=s(629),i=s(107),l=s(922),o=s(715),r=s(127);class d extends n.default{constructor(){super(document.createElement("div")),this.components=[new a.default,new i.default,new l.default,new o.default,new r.default],this.addClassName("glp-issue-modal-inner")}update(e){this.element.innerHTML="",this.components.forEach((t=>{t.update(e),this.element.appendChild(t.getElement())}))}}t.IssueModalContent=d},629:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=s(574);class a extends n.default{update(e){this.updateTitle(e.title)}}t.default=a},67:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImageLinks=void 0;t.ImageLinks=class{constructor(){this.linkReady="glp-link-ready"}getLinks(){const e=[...document.querySelectorAll(".no-attachment-icon")].filter((e=>!e.classList.contains(this.linkReady)&&/\.(png|jpg|jpeg|heic)$/.test(e.href)));return e.forEach((e=>{e.classList.add(this.linkReady)})),e}}},435:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IssueLinks=void 0;t.IssueLinks=class{constructor(){this.linkReady="glp-link-ready"}parseLink(e){const[t,s]=e.split("/-/issues/"),[n,a]=t.split(".com/");return{projectId:a.replace(/\//g,"%2F"),issueId:s.replace(/\D+/g,"")}}getLinks(){const e=[...document.querySelectorAll("a[href*=issues]")].filter((e=>!e.classList.contains(this.linkReady)&&/issues\/\d+/.test(e.href)));return e.forEach((e=>{e.classList.add(this.linkReady)})),e}}},472:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){let s=!1,n=0;e.addEventListener("mouseenter",(a=>{s=!0,n=window.setTimeout((()=>{s&&t.call(e,a)}),1e3)})),e.addEventListener("mouseleave",(()=>{clearTimeout(n),s=!1}))}},358:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IssueProvider=void 0;const n=s(803);t.IssueProvider=class{constructor(){this.cache=new n.default,this.url="https://gitlab.com/api/v4/",this.path="projects/:PROJECT_ID/issues?iids[]=:ISSUE_ID&with_labels_details=true"}async get(e,t){const s=this.cache.get(e);if(s)return s;const n=await fetch(`${this.url}${t}`),a=await n.json();return this.cache.set(e,a[0]),a[0]}async getIssue(e,t){return this.get(`glp-issue-${e}-${t}`,this.path.replace(":PROJECT_ID",e).replace(":ISSUE_ID",t))}}},803:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=class{get(e){try{const t=sessionStorage.getItem(e);if(t)return JSON.parse(t)}catch(e){return}}set(e,t){try{const s=JSON.stringify(t);sessionStorage.setItem(e,s)}catch(e){return}}}},573:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=s(981),a=s(67);t.default=class{constructor(){this.modal=new n.default,this.imageLink=new a.ImageLinks}init(){this.initLinks(),setInterval(this.initLinks.bind(this),3e3)}initLinks(){this.imageLink.getLinks().forEach((e=>{e.addEventListener("click",this.onClick.bind(this))}))}onClick(e){if(e.target)return e.preventDefault(),e.stopPropagation(),this.modal.show(this.elementSrc(e.target)),!1}elementSrc(e){return e instanceof HTMLAnchorElement?e.href:e instanceof HTMLImageElement?e.parentElement.href:""}}},775:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=s(968),a=s(435),i=s(472),l=s(358);t.default=class{constructor(){this.modal=new n.default,this.issue=new l.IssueProvider,this.issueLink=new a.IssueLinks}init(){this.initLinks(),setInterval(this.initLinks.bind(this),3e3)}initLinks(){this.issueLink.getLinks().forEach((e=>{(0,i.default)(e,this.onHover.bind(this)),e.addEventListener("mouseleave",this.onLeave.bind(this))}))}async onHover(e){this.modal.show(e);const t=e.target,{projectId:s,issueId:n}=this.issueLink.parseLink(t.href),a=await this.issue.getIssue(s,n);this.modal.updateContent(a)}onLeave(){this.modal.hide()}}}},t={};function s(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={id:n,exports:{}};return e[n](i,i.exports,s),i.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nc=void 0;(()=>{s(868);const e=s(775);[s(573).default,e.default].forEach((e=>(new e).init()))})()})();